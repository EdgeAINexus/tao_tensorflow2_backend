FROM gitlab-master.nvidia.com:5005/tlt/tao-tf2/tao_tf2_base_image@sha256:d0ed7ead05903fe3efd3c2efc0c635ee2d80952e4c912c203c9b5cf667d1d968

# Installing the TAO Toolkit source code packages.
WORKDIR /opt/nvidia
COPY dist/*.whl /opt/nvidia/wheels/
RUN python -m pip install pip --upgrade \
    && cd wheels && ls ./*.whl|xargs -I'{}' python -m pip install '{}' \
    && rm *.whl

RUN rm -rf /opt/nvidia/entrypoint.d/*.txt
COPY release/docker/entrypoint.d/* /opt/nvidia/entrypoint.d/

# Installing NGC CLI.
RUN mkdir -p /opt/ngccli && \
    wget "https://ngc.nvidia.com/downloads/ngccli_reg_linux.zip" -P /opt/ngccli && \
    unzip -u "/opt/ngccli/ngccli_reg_linux.zip" -d /opt/ngccli/ && \
    rm /opt/ngccli/*.zip && \
    chmod u+x /opt/ngccli/ngc-cli/ngc
ENV PATH="/opt/ngccli/ngc-cli:$PATH"

ENV NVIDIA_PRODUCT_NAME "TAO Toolkit"
ENV TAO_TOOLKIT_VERSION="4.0.0"
ENV NVIDIA_TAO_TOOLKIT_VERSION="${TAO_TOOLKIT_VERSION}-TF2"

CMD [ "/bin/bash" ]
